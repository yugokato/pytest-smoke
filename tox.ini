[tox]
env_list =
    py310-pytest{7,8,9,main}
    py311-pytest{7,8,9,main}
    py312-pytest{7,8,9,main}
    py313-pytest{8,9,main}
    py314-pytest{8,9,main}
    xdist{2,3}
    linting

[testenv]
package = wheel
wheel_build_env = .pkg
extras = test
deps =
    pytestmain: git+https://github.com/pytest-dev/pytest.git
    pytest9: pytest~=9.0
    pytest8: pytest~=8.0
    pytest7: pytest~=7.0
    xdist2: pytest-xdist~=2.0
    xdist3: pytest-xdist~=3.0
set_env =
    IGNORE_XDIST=true
    xdist{,2,3}: IGNORE_XDIST=false
    xdist{,2,3}: _TOX_PYTEST_FILTER_ARGS=-m xdist
commands =
    pytest tests {env:_TOX_PYTEST_FILTER_ARGS:} {posargs:-n auto}

[testenv:linting]
skip_install = True
allowlist_externals =
  pre-commit
commands = pre-commit run --all-files --show-diff-on-failure
